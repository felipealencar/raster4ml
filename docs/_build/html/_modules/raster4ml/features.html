<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>raster4ml.features &mdash; raster4ml 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> raster4ml
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../raster4ml.html">raster4ml package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">raster4ml</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>raster4ml.features</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for raster4ml.features</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utils</span>

<div class="viewcode-block" id="VegetationIndices"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices">[docs]</a><span class="k">class</span> <span class="nc">VegetationIndices</span><span class="p">():</span>
    
    <span class="sd">&quot;&quot;&quot;Calculate vegetation indices from a given multispectral image.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    image_path : str</span>
<span class="sd">        Path of the image.</span>
<span class="sd">    wavelengths : list or list of lists</span>
<span class="sd">        The wavelengths (in nanometer) of the bands in the stacked</span>
<span class="sd">        image. It can be either a list containing the center </span>
<span class="sd">        wavelengths of the bands, or it can be a list of lists </span>
<span class="sd">        where each element represents the initial and final wavelength.</span>

<span class="sd">        Example:</span>
<span class="sd">        If list: [430, 450, 560]</span>
<span class="sd">        If list of lists: [[420, 440], [530, 560], [670, 690]]</span>
<span class="sd">    bit_depth : int (optional)</span>
<span class="sd">        Bit depth of the image. For example, Landsat 8 images are</span>
<span class="sd">        14-bit. So if 14 is given as the bit_depth, then the image</span>
<span class="sd">        values will be divided by 2**14=16384.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    calculate(out_dir, featuers=&#39;all&#39;):</span>
<span class="sd">        Calculate all the vegetation indices possible.</span>
<span class="sd">        Allowed list of features are:</span>
<span class="sd">        &#39;ARI_1&#39;, &#39;ARI_2&#39;, &#39;ARVI&#39;, &#39;CRI_1&#39;, &#39;CRI_2&#39;, &#39;DVI&#39;, &#39;EVI&#39;,</span>
<span class="sd">        &#39;GEMI&#39;, &#39;GARI&#39;, &#39;GCI&#39;, &#39;GDVI&#39;, &#39;GLI&#39;, &#39;GNDVI&#39;, &#39;GOSAVI&#39;,</span>
<span class="sd">        &#39;GRVI&#39;, &#39;GSAVI&#39;, &#39;GVI&#39;, &#39;IPVI&#39;, &#39;LCAI&#39;, &#39;MCARI&#39;, &#39;MNLI&#39;,</span>
<span class="sd">        &#39;MNDWI&#39;, &#39;MRENDVI&#39;, &#39;MRESR&#39;, &#39;MSR&#39;, &#39;MSAVI_2&#39;, &#39;MTVI&#39;, &#39;MSI&#39;,</span>
<span class="sd">        &#39;NLI&#39;, &#39;NBR&#39;, &#39;NBRT_1&#39;, &#39;NDBI&#39;, &#39;NDII&#39;, &#39;NDLI&#39;, &#39;NDMI&#39;, </span>
<span class="sd">        &#39;NDNI&#39;, &#39;NDSI&#39;, &#39;NDVI&#39;, &#39;NDWI&#39;, &#39;NMDI&#39;, &#39;OSAVI&#39;, &#39;PRI&#39;,</span>
<span class="sd">        &#39;PSRI&#39;, &#39;RENDVI&#39;, &#39;RDVI&#39;, &#39;SR_1&#39;, &#39;SAVI&#39;, &#39;SIPI&#39;, &#39;TCARI&#39;,</span>
<span class="sd">        &#39;TDVI&#39;, &#39;TVI&#39;, &#39;VARI&#39;, &#39;VREI_1&#39;, &#39;VREI_2&#39;, &#39;WBI&#39;, &#39;WDRVI&#39;</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If invalid image path is given.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="n">bit_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructs all the necessary attributes for the </span>
<span class="sd">        VegetationIndices object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image_path : str</span>
<span class="sd">            Path of the image.</span>
<span class="sd">        wavelengths : list or list of lists</span>
<span class="sd">            The wavelengths (in nanometer) of the bands in the stacked</span>
<span class="sd">            image. It can be either a list containing the center </span>
<span class="sd">            wavelengths of the bands, or it can be a list of lists </span>
<span class="sd">            where each element represents the initial and final</span>
<span class="sd">            wavelength.</span>

<span class="sd">            Example:</span>
<span class="sd">            If list: [430, 450, 560]</span>
<span class="sd">            If list of lists: [[420, 440], [530, 560], [670, 690]]</span>
<span class="sd">        bit_depth : int (optional)</span>
<span class="sd">            Bit depth of the image. For example, Landsat 8 images are</span>
<span class="sd">            14-bit. So if 14 is given as the bit_depth, then the image</span>
<span class="sd">            values will be divided by 2**14=16384.</span>

<span class="sd">        Methods</span>
<span class="sd">        -------</span>
<span class="sd">        calculate(out_dir, featuers=&#39;all&#39;):</span>
<span class="sd">            Calculate all the vegetation indices possible.</span>
<span class="sd">            Allowed list of features are:</span>
<span class="sd">            &#39;ARI_1&#39;, &#39;ARI_2&#39;, &#39;ARVI&#39;, &#39;CRI_1&#39;, &#39;CRI_2&#39;, &#39;DVI&#39;, &#39;EVI&#39;,</span>
<span class="sd">            &#39;GEMI&#39;, &#39;GARI&#39;, &#39;GCI&#39;, &#39;GDVI&#39;, &#39;GLI&#39;, &#39;GNDVI&#39;, &#39;GOSAVI&#39;,</span>
<span class="sd">            &#39;GRVI&#39;, &#39;GSAVI&#39;, &#39;GVI&#39;, &#39;IPVI&#39;, &#39;LCAI&#39;, &#39;MCARI&#39;, &#39;MNLI&#39;,</span>
<span class="sd">            &#39;MNDWI&#39;, &#39;MRENDVI&#39;, &#39;MRESR&#39;, &#39;MSR&#39;, &#39;MSAVI_2&#39;, &#39;MTVI&#39;,</span>
<span class="sd">            &#39;MSI&#39;, &#39;NLI&#39;, &#39;NBR&#39;, &#39;NBRT_1&#39;, &#39;NDBI&#39;, &#39;NDII&#39;, &#39;NDLI&#39;,</span>
<span class="sd">            &#39;NDMI&#39;, &#39;NDNI&#39;, &#39;NDSI&#39;, &#39;NDVI&#39;, &#39;NDWI&#39;, &#39;NMDI&#39;, &#39;OSAVI&#39;,</span>
<span class="sd">            &#39;PRI&#39;, &#39;PSRI&#39;, &#39;RENDVI&#39;, &#39;RDVI&#39;, &#39;SR_1&#39;, &#39;SAVI&#39;, &#39;SIPI&#39;,</span>
<span class="sd">            &#39;TCARI&#39;, &#39;TDVI&#39;, &#39;TVI&#39;, &#39;VARI&#39;, &#39;VREI_1&#39;, &#39;VREI_2&#39;, &#39;WBI&#39;,</span>
<span class="sd">            &#39;WDRVI&#39;</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If invalid image path is given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_path</span> <span class="o">=</span> <span class="n">image_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="c1"># Define nodata</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">nodata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">nodata</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        
        <span class="c1"># Apply bit_depth if given</span>
        <span class="k">if</span> <span class="n">bit_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bit_depth</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span> <span class="o">/</span> <span class="mf">2.</span><span class="o">**</span><span class="n">bit_depth</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid input in bit_depth. Only int is accepted.&quot;</span><span class="p">)</span>
            
        <span class="c1"># Check if number of elements in wavelengths matches the number of bands</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of elements in wavelengths and number of bands do not match.&quot;</span><span class="p">)</span>
        
        <span class="c1"># Find band wavelengths</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span> <span class="o">=</span> <span class="p">[(</span><span class="n">el</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">el</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1">#list of lists</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid input of wavelengths. It has to </span><span class="se">\</span>
<span class="s2">                be a list of integers for center wavelengths and list </span><span class="se">\</span>
<span class="s2">                of lists with start and end wavelength for each band.&quot;</span><span class="p">)</span>
            
        <span class="c1"># Define the nearest bands</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R445</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">445</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R450</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">450</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R475</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">475</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R485</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">485</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R500</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R510</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">510</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R531</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">531</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R550</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">550</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R560</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">560</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R570</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">570</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R660</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">660</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R670</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">670</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R680</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">680</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R700</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">700</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R705</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">705</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R715</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">715</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R720</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">720</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R726</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">726</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R734</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">734</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R740</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">740</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R747</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">747</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R750</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">750</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R795</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">795</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R800</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R819</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">819</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R830</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">830</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R850</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">850</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R857</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">857</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R860</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">860</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R900</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">900</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R970</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">970</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R990</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">990</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R1145</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">1145</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R1241</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">1241</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R1510</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">1510</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R1599</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">1599</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R1640</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">1640</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R1649</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">1649</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R1650</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">1650</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R1680</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">1680</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R1754</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">1754</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R2000</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R2100</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">2100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R2130</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">2130</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R2165</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">2165</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R2200</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">2200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R2205</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">2205</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R2215</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">2215</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R2330</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_band</span><span class="p">(</span><span class="mi">2330</span><span class="p">)</span>
        
    
<div class="viewcode-block" id="VegetationIndices.nearest_band"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.nearest_band">[docs]</a>    <span class="k">def</span> <span class="nf">nearest_band</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find the nearest band of the image from given wavelength.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelength : float</span>
<span class="sd">            The wavelength in nm.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy nd-array</span>
<span class="sd">            The image numpy nd-array with selected bands matching the</span>
<span class="sd">            wavelength.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">difference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">)</span> <span class="o">-</span> <span class="n">wavelength</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">difference</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">difference</span><span class="o">.</span><span class="n">argmin</span><span class="p">()]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>
        
<div class="viewcode-block" id="VegetationIndices.ARI_1"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.ARI_1">[docs]</a>    <span class="k">def</span> <span class="nf">ARI_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Anthocyanin Reflectance Index 1 (ARI1)</span>
<span class="sd">        URL: https://doi.org/10.1562/0031-8655(2001)074%3C0038:OPANEO%3E2.0.CO;2</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R700</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.ARI_2"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.ARI_2">[docs]</a>    <span class="k">def</span> <span class="nf">ARI_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Anthocyanin Reflectance Index 2 (ARI2)</span>
<span class="sd">        URL: https://doi.org/10.1562/0031-8655(2001)074%3C0038:OPANEO%3E2.0.CO;2</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R800</span><span class="o">*</span><span class="p">((</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R700</span><span class="p">))</span></div>

<div class="viewcode-block" id="VegetationIndices.ARVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.ARVI">[docs]</a>    <span class="k">def</span> <span class="nf">ARVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Atmospherically Resistant Vegetation Index (ARVI)</span>
<span class="sd">        URL: https://doi.org/10.1109/36.134076</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R800</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R680</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R450</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R680</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R800</span><span class="o">+</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R680</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R450</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R680</span><span class="p">)))</span></div>

<div class="viewcode-block" id="VegetationIndices.CRI_1"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.CRI_1">[docs]</a>    <span class="k">def</span> <span class="nf">CRI_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Carotenoid Reflectance Index 1 (CRI1)</span>
<span class="sd">        URL: https://calmit.unl.edu/people/agitelson2/pdf/08_2002_P&amp;P_carotenoid.pdf</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R510</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.CRI_2"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.CRI_2">[docs]</a>    <span class="k">def</span> <span class="nf">CRI_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Carotenoid Reflectance Index 2 (CRI2)</span>
<span class="sd">        URL: https://calmit.unl.edu/people/agitelson2/pdf/08_2002_P&amp;P_carotenoid.pdf</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R510</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R700</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.CAI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.CAI">[docs]</a>    <span class="k">def</span> <span class="nf">CAI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cellulose Absorption Index (CAI)</span>
<span class="sd">        URL: https://naldc.nal.usda.gov/download/12951/PDF</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2000</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R2200</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R2100</span></div>

<div class="viewcode-block" id="VegetationIndices.DVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.DVI">[docs]</a>    <span class="k">def</span> <span class="nf">DVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Difference Vegetation Index (DVI)</span>
<span class="sd">        URL: https://doi.org/10.1016/0034-4257(79)90013-0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span></div>

<div class="viewcode-block" id="VegetationIndices.EVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.EVI">[docs]</a>    <span class="k">def</span> <span class="nf">EVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enhanced Vegetation Index (EVI)</span>
<span class="sd">        URL: https://doi.org/10.1016/S0034-4257(02)00096-2</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">2.5</span><span class="o">*</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="p">(</span><span class="mf">6.</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mf">7.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R475</span><span class="p">)</span><span class="o">+</span><span class="mf">1.</span><span class="p">))</span></div>

<div class="viewcode-block" id="VegetationIndices.GEMI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.GEMI">[docs]</a>    <span class="k">def</span> <span class="nf">GEMI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Global Environmental Monitoring Index (GEMI)</span>
<span class="sd">        URL: https://link.springer.com/article/10.1007/BF00031911</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">eta</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">))</span><span class="o">+</span><span class="mf">1.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">eta</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span><span class="o">-</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="o">-</span><span class="mf">0.125</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">))</span></div>

<div class="viewcode-block" id="VegetationIndices.GARI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.GARI">[docs]</a>    <span class="k">def</span> <span class="nf">GARI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Green Atmospherically Resistant Index (GARI)</span>
<span class="sd">        URL: https://doi.org/10.1016/S0034-4257(96)00072-7</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">-</span><span class="mf">1.7</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R475</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">-</span><span class="mf">1.7</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R475</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)))</span></div>

<div class="viewcode-block" id="VegetationIndices.GCI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.GCI">[docs]</a>    <span class="k">def</span> <span class="nf">GCI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Green Chlorophyll Index (GCI)</span>
<span class="sd">        URL: https://doi.org/10.1078/0176-1617-00887</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">)</span><span class="o">-</span><span class="mf">1.</span></div>

<div class="viewcode-block" id="VegetationIndices.GDVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.GDVI">[docs]</a>    <span class="k">def</span> <span class="nf">GDVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Green Difference Vegetation Index (GDVI)</span>
<span class="sd">        URL: https://repository.lib.ncsu.edu/handle/1840.16/4200</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span></div>

<div class="viewcode-block" id="VegetationIndices.GLI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.GLI">[docs]</a>    <span class="k">def</span> <span class="nf">GLI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Green Leaf Index (GLI)</span>
<span class="sd">        URL: https://doi.org/10.1080/10106040108542184</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R475</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R475</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.GNDVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.GNDVI">[docs]</a>    <span class="k">def</span> <span class="nf">GNDVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Green Normalized Difference Vegetation Index (GNDVI)</span>
<span class="sd">        URL: https://doi.org/10.1016/S0273-1177(97)01133-2</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.GOSAVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.GOSAVI">[docs]</a>    <span class="k">def</span> <span class="nf">GOSAVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Green Optimized Soil Adjusted Vegetation Index (GOSAVI)</span>
<span class="sd">        URL: https://repository.lib.ncsu.edu/handle/1840.16/4200</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;GOSAVI&#39;</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">+</span><span class="mf">0.16</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.GRVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.GRVI">[docs]</a>    <span class="k">def</span> <span class="nf">GRVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Green Ratio Vegetation Index (GRVI)</span>
<span class="sd">        URL: https://doi.org/10.2134/agronj2005.0200</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span></div>

<div class="viewcode-block" id="VegetationIndices.GSAVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.GSAVI">[docs]</a>    <span class="k">def</span> <span class="nf">GSAVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Green Soil Adjusted Vegetation Index (GSAVI)</span>
<span class="sd">        URL: https://repository.lib.ncsu.edu/handle/1840.16/4200</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">1.5</span><span class="o">*</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">+</span><span class="mf">0.5</span><span class="p">))</span></div>

<div class="viewcode-block" id="VegetationIndices.GVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.GVI">[docs]</a>    <span class="k">def</span> <span class="nf">GVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Green Vegetation Index (GVI)</span>
<span class="sd">        URL: https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.461.6381&amp;rep=rep1&amp;type=pdf</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.2848</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R485</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2435</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R560</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5436</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mf">0.7243</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R830</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mf">0.0840</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R1650</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1800</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R2215</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.IPVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.IPVI">[docs]</a>    <span class="k">def</span> <span class="nf">IPVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Infrared Percentage Vegetation Index (IPVI)</span>
<span class="sd">        URL: https://doi.org/10.1016/0034-4257(90)90085-Z</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.LCAI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.LCAI">[docs]</a>    <span class="k">def</span> <span class="nf">LCAI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Lignin Cellulose Absorption Index (LCAI)</span>
<span class="sd">        URL: https://doi.org/10.2134/agronj2003.0291</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">100.</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2205</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R2165</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R2205</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R2330</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.MCARI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.MCARI">[docs]</a>    <span class="k">def</span> <span class="nf">MCARI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modified Chlorophyll Absorption Ratio Index (MCARI)</span>
<span class="sd">        URL: https://doi.org/10.1016/S0034-4257(00)00113-9</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">R700</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R670</span><span class="p">)</span><span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R700</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R700</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R670</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.MNLI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.MNLI">[docs]</a>    <span class="k">def</span> <span class="nf">MNLI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modified Non-Linear Index (MNLI)</span>
<span class="sd">        URL: https://www.asprs.org/a/publications/proceedings/pecora17/0041.pdf</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>  
        <span class="k">return</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">*</span><span class="mf">1.5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.MNDWI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.MNDWI">[docs]</a>    <span class="k">def</span> <span class="nf">MNDWI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modified Normalized Difference Water Index (MNDWI)</span>
<span class="sd">        URL: https://doi.org/10.1080/01431160600589179</span>
<span class="sd">        URL: https://doi.org/10.1080/01431169608948714</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R1650</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R1650</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.MRENDVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.MRENDVI">[docs]</a>    <span class="k">def</span> <span class="nf">MRENDVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modified Red Edge Normalized Difference Vegetation Index (MRENDVI)</span>
<span class="sd">        URL: https://doi.org/10.1016/S0176-1617(99)80314-9</span>
<span class="sd">        URL: https://doi.org/10.1016/S0034-4257(02)00010-X</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R750</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R705</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R750</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R705</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R445</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.MRESR"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.MRESR">[docs]</a>    <span class="k">def</span> <span class="nf">MRESR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modified Red Edge Simple Ratio (MRESR)</span>
<span class="sd">        URL: https://doi.org/10.1016/S0034-4257(02)00010-X</span>
<span class="sd">        URL: https://doi.org/10.1016/S0176-1617(99)80314-9</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R750</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R445</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R705</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R445</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.MSR"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.MSR">[docs]</a>    <span class="k">def</span> <span class="nf">MSR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modified Red Edge Simple Ratio (MRESR)</span>
<span class="sd">        URL: https://doi.org/10.1080/07038992.1996.10855178</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>  
        <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.MSAVI_2"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.MSAVI_2">[docs]</a>    <span class="k">def</span> <span class="nf">MSAVI_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modified Soil Adjusted Vegetation Index 2 (MSAVI2)</span>
<span class="sd">        URL: https://doi.org/10.1016/0034-4257(94)90134-1</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="mf">1.</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="p">)</span><span class="o">-</span><span class="mf">8.</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)))</span><span class="o">/</span><span class="mf">2.</span></div>

<div class="viewcode-block" id="VegetationIndices.MTVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.MTVI">[docs]</a>    <span class="k">def</span> <span class="nf">MTVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modified Triangular Vegetation Index (MTVI)</span>
<span class="sd">        URL: https://doi.org/10.1016/j.rse.2003.12.013</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">1.2</span><span class="o">*</span><span class="p">(</span><span class="mf">1.2</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R800</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">)</span><span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R670</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">))</span></div>

<div class="viewcode-block" id="VegetationIndices.MSI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.MSI">[docs]</a>    <span class="k">def</span> <span class="nf">MSI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Moisture Stress Index (MSI)</span>
<span class="sd">        URL: https://doi.org/10.1016/0034-4257(89)90046-1</span>
<span class="sd">        URL: https://doi.org/10.1016/S0034-4257(01)00191-2</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R1599</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R819</span></div>

<div class="viewcode-block" id="VegetationIndices.NLI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NLI">[docs]</a>    <span class="k">def</span> <span class="nf">NLI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Non-Linear Index (NLI)</span>
<span class="sd">        URL: https://doi.org/10.1080/02757259409532252</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.NBR"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NBR">[docs]</a>    <span class="k">def</span> <span class="nf">NBR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalized Burn Ratio (NBR)</span>
<span class="sd">        URL: https://doi.org/10.1080/10106049109354290</span>
<span class="sd">        URL: https://pubs.er.usgs.gov/publication/2002085</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R2215</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R2215</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.NBRT_1"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NBRT_1">[docs]</a>    <span class="k">def</span> <span class="nf">NBRT_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalized Burn Ratio Thermal 1 (NBRT1)</span>
<span class="sd">        URL: https://www.fs.usda.gov/treesearch/pubs/24608</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R2215</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R1145</span><span class="o">/</span><span class="mf">1000.</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R2215</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R1145</span><span class="o">/</span><span class="mf">1000.</span><span class="p">))</span></div>

<div class="viewcode-block" id="VegetationIndices.NDBI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NDBI">[docs]</a>    <span class="k">def</span> <span class="nf">NDBI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalized Difference Built-Up Index (NDBI)</span>
<span class="sd">        URL: https://doi.org/10.1080/01431160304987</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R1650</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R830</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R1650</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R830</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.NDII"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NDII">[docs]</a>    <span class="k">def</span> <span class="nf">NDII</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalized Difference Infrared Index (NDII)</span>
<span class="sd">        URL: https://www.asprs.org/wp-content/uploads/pers/1983journal/jan/1983_jan_77-83.pdf</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R819</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R1649</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R819</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R1649</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.NDLI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NDLI">[docs]</a>    <span class="k">def</span> <span class="nf">NDLI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalized Difference Lignin Index (NDLI)</span>
<span class="sd">        URL: https://doi.org/10.1016/S0034-4257(02)00011-1</span>
<span class="sd">        URL: https://doi.org/10.1016/0034-4257(95)00234-0</span>
<span class="sd">        URL: https://doi.org/10.2307/1936780</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R1754</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R1680</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R1754</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R1680</span><span class="p">))</span></div>

<div class="viewcode-block" id="VegetationIndices.NDMI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NDMI">[docs]</a>    <span class="k">def</span> <span class="nf">NDMI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalized Difference Mud Index (NDMI)</span>
<span class="sd">        URL: https://doi.org/10.1117/1.OE.51.11.111719</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R795</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R990</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R795</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R990</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.NDNI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NDNI">[docs]</a>    <span class="k">def</span> <span class="nf">NDNI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalized Difference Nitrogen Index (NDNI)</span>
<span class="sd">        URL: https://doi.org/10.1016/S0034-4257(02)00011-1</span>
<span class="sd">        URL: https://doi.org/10.1016/0034-4257(95)00234-0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R1510</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R1680</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R1510</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R1680</span><span class="p">))</span></div>

<div class="viewcode-block" id="VegetationIndices.NDSI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NDSI">[docs]</a>    <span class="k">def</span> <span class="nf">NDSI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalized Difference Snow Index (NDSI)</span>
<span class="sd">        URL: https://doi.org/10.1016/0034-4257(95)00137-P</span>
<span class="sd">        URL: https://doi.org/10.1016/j.rse.2003.10.016</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R1650</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R1650</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.NDVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NDVI">[docs]</a>    <span class="k">def</span> <span class="nf">NDVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalized Difference Vegetation Index (NDVI)</span>
<span class="sd">        URL: https://ntrs.nasa.gov/citations/19740022614</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.NDWI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NDWI">[docs]</a>    <span class="k">def</span> <span class="nf">NDWI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalized Difference Water Index (NDWI)</span>
<span class="sd">        URL: https://doi.org/10.1016/S0034-4257(96)00067-3</span>
<span class="sd">        URL: https://doi.org/10.1016/j.rse.2003.10.021</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R857</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R1241</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R857</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R1241</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.NMDI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.NMDI">[docs]</a>    <span class="k">def</span> <span class="nf">NMDI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalized Multi-band Drought Index (NMDI)</span>
<span class="sd">        URL: https://doi.org/10.1029/2007GL031021</span>
<span class="sd">        URL: https://doi.org/10.1016/j.agrformet.2008.06.005</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R860</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R1640</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R2130</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R860</span><span class="o">+</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R1640</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R2130</span><span class="p">))</span></div>

<div class="viewcode-block" id="VegetationIndices.OSAVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.OSAVI">[docs]</a>    <span class="k">def</span> <span class="nf">OSAVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Optimized Soil Adjusted Vegetation Index (OSAVI)</span>
<span class="sd">        URL: https://doi.org/10.1016/0034-4257(95)00186-7</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="o">+</span><span class="mf">0.16</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.PRI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.PRI">[docs]</a>    <span class="k">def</span> <span class="nf">PRI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Photochemical Reflectance Index (PRI)</span>
<span class="sd">        URL: https://doi.org/10.1111/j.1469-8137.1995.tb03064.x</span>
<span class="sd">        URL: https://link.springer.com/article/10.1007/s004420050337</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R531</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R570</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R531</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R570</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.PSRI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.PSRI">[docs]</a>    <span class="k">def</span> <span class="nf">PSRI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plant Senescence Reflectance Index (PSRI)</span>
<span class="sd">        URL: https://doi.org/10.1034/j.1399-3054.1999.106119.x</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R680</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R500</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R750</span></div>

<div class="viewcode-block" id="VegetationIndices.RENDVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.RENDVI">[docs]</a>    <span class="k">def</span> <span class="nf">RENDVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Red Edge Normalized Difference Vegetation Index (RENDVI)</span>
<span class="sd">        URL: https://doi.org/10.1016/S0176-1617(11)81633-0</span>
<span class="sd">        URL: https://doi.org/10.1016/S0034-4257(02)00010-X</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R750</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R705</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R750</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R705</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.RDVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.RDVI">[docs]</a>    <span class="k">def</span> <span class="nf">RDVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Renormalized Difference Vegetation Index (RDVI)</span>
<span class="sd">        URL: https://doi.org/10.1016/0034-4257(94)00114-3</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">))</span></div>

<div class="viewcode-block" id="VegetationIndices.SR_1"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.SR_1">[docs]</a>    <span class="k">def</span> <span class="nf">SR_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Simple Ratio (SR_1)</span>
<span class="sd">        URL: https://doi.org/10.2134/agronj1968.00021962006000060016x</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span></div>

<div class="viewcode-block" id="VegetationIndices.SAVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.SAVI">[docs]</a>    <span class="k">def</span> <span class="nf">SAVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Simple Ratio (SR_1)</span>
<span class="sd">        URL: https://doi.org/10.2134/agronj1968.00021962006000060016x</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.SIPI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.SIPI">[docs]</a>    <span class="k">def</span> <span class="nf">SIPI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Structure Insensitive Pigment Index (SIPI)</span>
<span class="sd">        URL: https://publons.com/publon/483937/</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R800</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R445</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R800</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R680</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.TCARI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.TCARI">[docs]</a>    <span class="k">def</span> <span class="nf">TCARI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Transformed Chlorophyll Absorption Reflectance Index (TCARI)</span>
<span class="sd">        URL: https://doi.org/10.1016/j.rse.2003.12.013</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">3.</span><span class="o">*</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">R700</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R670</span><span class="p">)</span><span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R700</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R700</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R670</span><span class="p">))</span></div>

<div class="viewcode-block" id="VegetationIndices.TDVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.TDVI">[docs]</a>    <span class="k">def</span> <span class="nf">TDVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Transformed Difference Vegetation Index (TDVI)</span>
<span class="sd">        URL: https://doi.org/10.1109/IGARSS.2002.1026867</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">1.5</span><span class="o">*</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)))</span></div>

<div class="viewcode-block" id="VegetationIndices.TVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.TVI">[docs]</a>    <span class="k">def</span> <span class="nf">TVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Triangular Vegetation Index (TVI)</span>
<span class="sd">        URL: https://doi.org/10.1016/S0034-4257(00)00197-8</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">120.</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R750</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">)</span><span class="o">-</span><span class="mf">200.</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R670</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="p">))</span><span class="o">/</span><span class="mf">2.</span></div>

<div class="viewcode-block" id="VegetationIndices.VARI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.VARI">[docs]</a>    <span class="k">def</span> <span class="nf">VARI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Visible Atmospherically Resistant Index (VARI)</span>
<span class="sd">        URL: https://doi.org/10.1080/01431160110107806</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R550</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R475</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.VREI_1"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.VREI_1">[docs]</a>    <span class="k">def</span> <span class="nf">VREI_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Vogelmann Red Edge Index 1 (VREI1)</span>
<span class="sd">        URL: https://doi.org/10.1080/01431169308953986</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R740</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R720</span></div>

<div class="viewcode-block" id="VegetationIndices.VREI_2"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.VREI_2">[docs]</a>    <span class="k">def</span> <span class="nf">VREI_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Vogelmann Red Edge Index 2 (VREI2)</span>
<span class="sd">        URL: https://doi.org/10.1080/01431169308953986</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R734</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R747</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R715</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R726</span><span class="p">)</span></div>

<div class="viewcode-block" id="VegetationIndices.WBI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.WBI">[docs]</a>    <span class="k">def</span> <span class="nf">WBI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Water Band Index (WBI)</span>
<span class="sd">        URL: https://doi.org/10.1080/01431169308954010</span>
<span class="sd">        URL: https://www.researchgate.net/publication/260000104_Mapping_crop_water_stress_issues_of_scale_in_the_detection_of_plant_water_status_using_hyperspectral_indices</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R970</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R900</span></div>

<div class="viewcode-block" id="VegetationIndices.WDRVI"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.WDRVI">[docs]</a>    <span class="k">def</span> <span class="nf">WDRVI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wide Dynamic Range Vegetation Index (WDRVI)</span>
<span class="sd">        URL: https://doi.org/10.1078/0176-1617-01176</span>
<span class="sd">        URL: https://digitalcommons.unl.edu/cgi/viewcontent.cgi?article=1264&amp;context=natrespapers</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy 2d-array</span>
<span class="sd">            A 2D numpy array of calcualted feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">R850</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">R660</span><span class="p">)</span> </div>
    
    
<div class="viewcode-block" id="VegetationIndices.calculate"><a class="viewcode-back" href="../../raster4ml.html#raster4ml.features.VegetationIndices.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
        
        <span class="sd">&quot;&quot;&quot;_summary_</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        out_dir : str</span>
<span class="sd">            Path of the directory where indice(s) will be saved.</span>
<span class="sd">        features : str or list (optional)</span>
<span class="sd">            If &#39;all&#39; then all the vegetation indices available in the</span>
<span class="sd">            package will be calculated. Or the user can put the names</span>
<span class="sd">            of the indices to calculate in a list. Allowable indices</span>
<span class="sd">            are:</span>
<span class="sd">            &#39;ARI_1&#39;, &#39;ARI_2&#39;, &#39;ARVI&#39;, &#39;CRI_1&#39;, &#39;CRI_2&#39;, &#39;DVI&#39;, &#39;EVI&#39;,</span>
<span class="sd">            &#39;GEMI&#39;, &#39;GARI&#39;, &#39;GCI&#39;, &#39;GDVI&#39;, &#39;GLI&#39;, &#39;GNDVI&#39;, &#39;GOSAVI&#39;,</span>
<span class="sd">            &#39;GRVI&#39;, &#39;GSAVI&#39;, &#39;GVI&#39;, &#39;IPVI&#39;, &#39;LCAI&#39;, &#39;MCARI&#39;, &#39;MNLI&#39;,</span>
<span class="sd">            &#39;MNDWI&#39;, &#39;MRENDVI&#39;, &#39;MRESR&#39;, &#39;MSR&#39;, &#39;MSAVI_2&#39;, &#39;MTVI&#39;,</span>
<span class="sd">            &#39;MSI&#39;, &#39;NLI&#39;, &#39;NBR&#39;, &#39;NBRT_1&#39;, &#39;NDBI&#39;, &#39;NDII&#39;, &#39;NDLI&#39;,</span>
<span class="sd">            &#39;NDMI&#39;, &#39;NDNI&#39;, &#39;NDSI&#39;, &#39;NDVI&#39;, &#39;NDWI&#39;, &#39;NMDI&#39;, &#39;OSAVI&#39;,</span>
<span class="sd">            &#39;PRI&#39;, &#39;PSRI&#39;, &#39;RENDVI&#39;, &#39;RDVI&#39;, &#39;SR_1&#39;, &#39;SAVI&#39;, &#39;SIPI&#39;,</span>
<span class="sd">            &#39;TCARI&#39;, &#39;TDVI&#39;, &#39;TVI&#39;, &#39;VARI&#39;, &#39;VREI_1&#39;, &#39;VREI_2&#39;, &#39;WBI&#39;,</span>
<span class="sd">            &#39;WDRVI&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            Saves the output indices.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="k">if</span> <span class="n">features</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">features</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_vegetation_indices_names</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Calculating all features&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Calculating </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span><span class="si">}</span><span class="s1"> features&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid input in features. Only support list of featues or &#39;all&#39;.&quot;</span><span class="p">)</span>

        <span class="n">not_calculated_features</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
            <span class="n">out_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">feature</span><span class="o">+</span><span class="s1">&#39;.tif&#39;</span><span class="p">)</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">feature</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
                <span class="n">feature</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">feature</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">feature</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">utils</span><span class="o">.</span><span class="n">save_raster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">out_path</span><span class="p">,</span>
                                  <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;GTiff&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">not_calculated_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_calculated_features</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">not_calculated_features</span><span class="p">)</span><span class="si">}</span><span class="s1"> features could not be calculated.&#39;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="kc">None</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Sourav Bhadra.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>